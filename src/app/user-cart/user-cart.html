<!-- üéÆ Navbar -->
<app-user-navbar [balance]="balance" [cartCount]="cartCount"></app-user-navbar>

<!-- üõí ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ -->
<div class="cart-container">
  <div class="cart-box">
    <h2 class="cart-title">üõí ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>

    <!-- ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
    <div *ngIf="cart.length > 0; else emptyCart">
      <div class="cart-item" *ngFor="let it of cart">
        <img [src]="imageUrl(it)" alt="Game Image" class="item-img" />


        <div class="item-info">
          <h3 class="title">{{ it.title }}</h3>
          <div class="qty-row">

            <span class="qty">{{ it.qty }}</span>

          </div>

        </div>

        <div class="price-col">
          <div class="unit">‡∏ø{{ it.price | number:'1.0-0' }}</div>
          <div class="total">‡∏ø{{ itemTotal(it) | number:'1.0-0' }}</div>
        </div>

        <button class="btn-remove" (click)="removeFromCart(it)">‡∏•‡∏ö</button>
      </div>

      <!-- üîπ ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î -->
      <div class="discount-section">
        <label>üéüÔ∏è ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î</label>
        <select [(ngModel)]="selectedCoupon" (change)="applyDiscount()">
          <option value="">-- ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á --</option>
          <option *ngFor="let c of coupons" [ngValue]="c">
            {{ c.code }}
            ({{ c.isPercent ? c.amount + '%' : '‡∏ø' + c.amount }})
          </option>
        </select>
      </div>


      <!-- üîπ ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏Ñ‡∏≤ -->
      <div class="summary">
        <p>‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏ï‡πá‡∏° : ‡∏ø{{ totalPrice | number:'1.0-0' }}</p>
        <p *ngIf="discountValue > 0">‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î : ‚àí‡∏ø{{ discountValue | number:'1.0-0' }}</p>
        <h3>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏¥‡πâ‡∏ô : <span>‡∏ø{{ finalPrice | number:'1.0-0' }}</span></h3>
      </div>

      <button class="btn-pay" (click)="checkout()">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</button>
    </div>

    <!-- ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
    <ng-template #emptyCart>
      <p class="empty">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ üò¢</p>
    </ng-template>
  </div>
</div>